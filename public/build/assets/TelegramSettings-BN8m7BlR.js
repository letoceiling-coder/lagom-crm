import{_,e as a,h as e,f as x,t as l,i as r,v as p,m as c,D as b,y as V,r as i,o as U,G as y,d as u}from"./app-BLQrZaCa.js";import{S as v}from"./sweetalert2.esm.all-C0u8rGqG.js";const T={name:"TelegramSettings",setup(){const g=i(!0),t=i(!1),m=i(!1),o=i(null),d=i(null),f=i(null),s=async()=>{g.value=!0,o.value=null;try{const n=await y.get("/api/v1/telegram-settings");d.value=n.data.data.settings,f.value=n.data.data.bot_info}catch(n){o.value=n.response?.data?.message||"Ошибка загрузки настроек",console.error("Error fetching Telegram settings:",n)}finally{g.value=!1}},k=async()=>{t.value=!0,o.value=null;try{const n=await y.put("/api/v1/telegram-settings",d.value);n.data.data.bot_info&&(f.value=n.data.data.bot_info),await v.fire({icon:"success",title:"Успешно!",text:"Настройки успешно сохранены",timer:2e3,showConfirmButton:!1})}catch(n){o.value=n.response?.data?.message||"Ошибка сохранения настроек",await v.fire({icon:"error",title:"Ошибка",text:o.value})}finally{t.value=!1}},w=async()=>{m.value=!0;try{const n=await y.post("/api/v1/telegram-settings/test",{bot_token:d.value.bot_token,chat_id:d.value.chat_id});await v.fire({icon:"success",title:"Успешно!",text:"Тестовое сообщение отправлено",timer:2e3,showConfirmButton:!1})}catch(n){await v.fire({icon:"error",title:"Ошибка",text:n.response?.data?.message||"Не удалось отправить тестовое сообщение"})}finally{m.value=!1}};return U(()=>{s()}),{loading:g,saving:t,testing:m,error:o,settings:d,botInfo:f,saveSettings:k,testConnection:w}}},I={class:"telegram-settings-page space-y-6"},M={key:0,class:"flex items-center justify-center py-12"},C={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},S={class:"text-destructive"},B={key:2,class:"bg-card rounded-lg border border-border p-6 space-y-6"},D={class:"space-y-4"},L={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},N={key:0,class:"p-4 bg-muted/50 rounded-lg"},j={class:"text-sm text-foreground"},H={class:"space-y-4 border-t border-border pt-6"},A={class:"space-y-3"},E={class:"flex items-center gap-3 cursor-pointer"},G={class:"flex items-center gap-3 cursor-pointer"},R=["disabled"],q={class:"flex items-center gap-3 cursor-pointer"},z=["disabled"],F={class:"space-y-4 border-t border-border pt-6"},O={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},W={class:"space-y-3"},h={class:"flex items-center gap-3 cursor-pointer"},J={class:"flex items-center gap-3 cursor-pointer"},K={class:"flex items-center justify-between gap-4 border-t border-border pt-6"},P=["disabled"],Q=["disabled"];function X(g,t,m,o,d,f){return u(),a("div",I,[t[36]||(t[36]=e("div",null,[e("h1",{class:"text-3xl font-semibold text-foreground"},"Настройки Telegram бота"),e("p",{class:"text-muted-foreground mt-1"},"Настройка интеграции с Telegram для отправки уведомлений и ошибок")],-1)),o.loading?(u(),a("div",M,[...t[12]||(t[12]=[e("p",{class:"text-muted-foreground"},"Загрузка настроек...",-1)])])):x("",!0),o.error?(u(),a("div",C,[e("p",S,l(o.error),1)])):x("",!0),!o.loading&&o.settings?(u(),a("div",B,[e("div",D,[t[26]||(t[26]=e("h2",{class:"text-xl font-semibold text-foreground"},"Информация о боте",-1)),e("div",L,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Токен бота * ",-1)),r(e("input",{type:"password","onUpdate:modelValue":t[0]||(t[0]=s=>o.settings.bot_token=s),placeholder:"1234567890:ABCdefGHIjklMNOpqrsTUVwxyz",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[p,o.settings.bot_token]]),t[14]||(t[14]=e("p",{class:"text-xs text-muted-foreground mt-1"}," Получите токен у @BotFather в Telegram ",-1))]),e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Имя бота ",-1)),r(e("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=s=>o.settings.bot_name=s),placeholder:"Admin Bot",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[p,o.settings.bot_name]])])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," ID чата для уведомлений * ",-1)),r(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>o.settings.chat_id=s),placeholder:"123456789 или @channel_username",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[p,o.settings.chat_id]]),t[17]||(t[17]=e("p",{class:"text-xs text-muted-foreground mt-1"}," ID группы, канала или личного чата. Для получения ID отправьте боту /start и используйте @userinfobot ",-1))]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Webhook URL ",-1)),r(e("input",{type:"url","onUpdate:modelValue":t[3]||(t[3]=s=>o.settings.webhook_url=s),placeholder:"https://yourdomain.com/api/telegram/webhook",class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},null,512),[[p,o.settings.webhook_url]]),t[19]||(t[19]=e("p",{class:"text-xs text-muted-foreground mt-1"}," URL для получения обновлений от Telegram (опционально) ",-1))]),o.botInfo?(u(),a("div",N,[t[25]||(t[25]=e("h3",{class:"font-semibold text-foreground mb-2"},"Информация о боте:",-1)),e("p",j,[t[20]||(t[20]=e("strong",null,"Имя:",-1)),c(" "+l(o.botInfo.first_name)+" "+l(o.botInfo.last_name||""),1),t[21]||(t[21]=e("br",null,null,-1)),t[22]||(t[22]=e("strong",null,"Username:",-1)),c(" @"+l(o.botInfo.username),1),t[23]||(t[23]=e("br",null,null,-1)),t[24]||(t[24]=e("strong",null,"ID:",-1)),c(" "+l(o.botInfo.id),1)])])):x("",!0)]),e("div",H,[t[30]||(t[30]=e("h2",{class:"text-xl font-semibold text-foreground"},"Общие настройки",-1)),e("div",A,[e("label",E,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=s=>o.settings.is_enabled=s),class:"w-4 h-4 rounded border-border"},null,512),[[b,o.settings.is_enabled]]),t[27]||(t[27]=e("span",{class:"text-sm font-medium text-foreground"},"Включить бота",-1))]),e("label",G,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=s=>o.settings.send_notifications=s),disabled:!o.settings.is_enabled,class:"w-4 h-4 rounded border-border"},null,8,R),[[b,o.settings.send_notifications]]),t[28]||(t[28]=e("span",{class:"text-sm font-medium text-foreground"},"Отправлять уведомления",-1))]),e("label",q,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[6]||(t[6]=s=>o.settings.send_errors=s),disabled:!o.settings.is_enabled,class:"w-4 h-4 rounded border-border"},null,8,z),[[b,o.settings.send_errors]]),t[29]||(t[29]=e("span",{class:"text-sm font-medium text-foreground"},"Отправлять критические ошибки",-1))])])]),e("div",F,[t[35]||(t[35]=e("h2",{class:"text-xl font-semibold text-foreground"},"Настройки сообщений",-1)),e("div",O,[e("div",null,[t[32]||(t[32]=e("label",{class:"block text-sm font-medium text-foreground mb-2"}," Режим парсинга ",-1)),r(e("select",{"onUpdate:modelValue":t[7]||(t[7]=s=>o.settings.parse_mode=s),class:"w-full h-10 px-3 border border-border rounded bg-background text-sm"},[...t[31]||(t[31]=[e("option",{value:"HTML"},"HTML",-1),e("option",{value:"Markdown"},"Markdown",-1),e("option",{value:"MarkdownV2"},"MarkdownV2",-1)])],512),[[V,o.settings.parse_mode]])])]),e("div",W,[e("label",h,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=s=>o.settings.disable_notification=s),class:"w-4 h-4 rounded border-border"},null,512),[[b,o.settings.disable_notification]]),t[33]||(t[33]=e("span",{class:"text-sm font-medium text-foreground"},"Отправлять без звука",-1))]),e("label",J,[r(e("input",{type:"checkbox","onUpdate:modelValue":t[9]||(t[9]=s=>o.settings.disable_web_page_preview=s),class:"w-4 h-4 rounded border-border"},null,512),[[b,o.settings.disable_web_page_preview]]),t[34]||(t[34]=e("span",{class:"text-sm font-medium text-foreground"},"Отключить превью ссылок",-1))])])]),e("div",K,[e("button",{onClick:t[10]||(t[10]=(...s)=>o.testConnection&&o.testConnection(...s)),disabled:o.testing||!o.settings.bot_token||!o.settings.chat_id,class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},l(o.testing?"Отправка...":"Отправить тестовое сообщение"),9,P),e("button",{onClick:t[11]||(t[11]=(...s)=>o.saveSettings&&o.saveSettings(...s)),disabled:o.saving,class:"px-6 py-2 bg-accent text-accent-foreground rounded hover:bg-accent/90 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},l(o.saving?"Сохранение...":"Сохранить настройки"),9,Q)])])):x("",!0)])}const $=_(T,[["render",X]]);export{$ as default};
