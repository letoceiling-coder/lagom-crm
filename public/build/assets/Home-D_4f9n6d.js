import{_ as k,r as h,c as I,o as T,e as d,f as p,A as H,h as s,a as D,t as f,w as N,B as L,d as r,m as O,F as j,k as E,b as $,C as F,T as M,l as S,n as W,i as z,v as Q,j as J,g as K,D as Z,x as G}from"./app-DB74vpAh.js";const X={name:"HeroBanner",props:{slug:{type:String,default:"home-banner"}},setup(o){const t=h(null),a=h(!0),e=async()=>{try{const n=await fetch(`/api/public/banners/${o.slug}`);if(n.ok){const c=await n.json();c.data&&(t.value={...c.data,background_image:c.data.background_image?`/${c.data.background_image.replace(/^\//,"")}`:null,height_desktop:c.data.height_desktop||380,height_mobile:c.data.height_mobile||300})}}catch(n){console.error("Error fetching banner:",n)}finally{a.value=!1}},m=()=>{t.value.button_type==="method"&&console.log("Method button clicked:",t.value.button_value)},u=I(()=>{if(!t.value)return{};const n=t.value.height_desktop||380,c=t.value.height_mobile||300,v=n-c,y=`(${c}px + ${v} * ((100vw - 320px) / 880))`;return{"--banner-height-mobile":`${c}px`,"--banner-height-desktop":`${n}px`,minHeight:`${c}px`,height:`clamp(${c}px, ${y}, ${n}px)`}});return T(()=>{e()}),{banner:t,loading:a,bannerStyle:u,handleButtonClick:m}}},Y={class:"w-full px-3 sm:px-4 md:px-5 mt-3"},ee={class:"w-full max-w-2xl"},te={key:0,class:"space-y-2 sm:space-y-3 mb-6 sm:mb-8"},se={key:0,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},ne={key:1,class:"text-white text-2xl sm:text-3xl md:text-4xl lg:text-5xl xl:text-6xl font-semibold leading-tight drop-shadow-lg"},oe={key:2,class:"text-white text-lg sm:text-xl md:text-2xl lg:text-3xl font-normal leading-relaxed whitespace-pre-line drop-shadow-md"};function ae(o,t,a,e,m,u){return r(),d("div",Y,[e.banner&&e.banner.is_active?(r(),d("section",{key:0,class:"relative w-full max-w-[1200px] mx-auto rounded-lg overflow-hidden shadow-sm",style:H(e.bannerStyle)},[s("div",{class:"absolute inset-0 bg-cover bg-center bg-no-repeat bg-[#6C7B6D]",style:H({backgroundImage:e.banner.background_image?`url('${e.banner.background_image}')`:"none",backgroundSize:"cover",backgroundPosition:"center"})},null,4),s("div",{class:"relative z-10 w-full px-4 sm:px-6 lg:px-8 h-full flex items-center",style:H(e.bannerStyle)},[s("div",ee,[e.banner.heading_1||e.banner.heading_2||e.banner.description?(r(),d("div",te,[e.banner.heading_1?(r(),d("h1",se,f(e.banner.heading_1),1)):p("",!0),e.banner.heading_2?(r(),d("h2",ne,f(e.banner.heading_2),1)):p("",!0),e.banner.description?(r(),d("p",oe,f(e.banner.description),1)):p("",!0)])):p("",!0),e.banner.button_text?(r(),D(L(e.banner.button_type==="method"?"button":"router-link"),{key:1,to:e.banner.button_type==="url"?e.banner.button_value:void 0,onClick:e.handleButtonClick,class:"inline-block bg-[#657C6C] hover:bg-[#55695a] active:bg-[#48554a] text-white font-medium text-base sm:text-lg px-8 sm:px-10 md:px-12 py-3 sm:py-3.5 md:py-4 rounded-lg transition-all duration-200 transform hover:scale-[1.02] active:scale-100 shadow-lg"},{default:N(()=>[O(f(e.banner.button_text),1)]),_:1},8,["to","onClick"])):p("",!0)])],4)],4)):p("",!0)])}const re=k(X,[["render",ae]]),ie={name:"HowWork",setup(){const o=h(null),t=h(!0),a=async()=>{try{const e=await fetch("/api/public/how-work-block/settings");if(e.ok){const m=await e.json();m.data&&(o.value=m.data)}}catch(e){console.error("Error fetching HowWork block settings:",e)}finally{t.value=!1}};return T(()=>{a()}),{settings:o,loading:t}}},le={key:0,class:"w-full px-3 sm:px-4 md:px-5 py-8 sm:py-12 md:py-16 lg:py-20"},de={class:"w-full max-w-[1200px] mx-auto"},ce={key:0,class:"text-center mb-8 sm:mb-12 md:mb-16"},ue={key:0,class:"text-2xl sm:text-3xl md:text-4xl lg:text-5xl font-bold text-foreground mb-4 sm:mb-6"},me={key:1,class:"text-base sm:text-lg md:text-xl text-muted-foreground max-w-3xl mx-auto"},xe={key:1,class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 md:gap-10"},fe={class:"flex items-center justify-center w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-accent text-accent-foreground font-bold text-xl sm:text-2xl mb-4 sm:mb-6"},ge={key:0},he={key:1},be={key:0,class:"text-lg sm:text-xl md:text-2xl font-semibold text-foreground mb-3 sm:mb-4"},_e={key:1,class:"text-sm sm:text-base text-muted-foreground leading-relaxed"},pe={key:2,class:"text-center py-12 text-muted-foreground"};function ve(o,t,a,e,m,u){return e.settings&&e.settings.is_active?(r(),d("section",le,[s("div",de,[e.settings.title||e.settings.subtitle?(r(),d("div",ce,[e.settings.title?(r(),d("h2",ue,f(e.settings.title),1)):p("",!0),e.settings.subtitle?(r(),d("p",me,f(e.settings.subtitle),1)):p("",!0)])):p("",!0),e.settings.steps&&e.settings.steps.length>0?(r(),d("div",xe,[(r(!0),d(j,null,E(e.settings.steps,(n,c)=>(r(),d("div",{key:c,class:"relative bg-card border border-border rounded-lg p-6 sm:p-8 hover:shadow-lg transition-all duration-300 hover:-translate-y-1"},[s("div",fe,[n.icon?(r(),d("span",ge,f(n.icon),1)):(r(),d("span",he,f(c+1),1))]),n.title?(r(),d("h3",be,f(n.title),1)):p("",!0),n.description?(r(),d("p",_e,f(n.description),1)):p("",!0)]))),128))])):(r(),d("div",pe,[...t[0]||(t[0]=[s("p",null,"Шаги не настроены. Добавьте шаги в настройках блока.",-1)])]))])])):p("",!0)}const ye=k(ie,[["render",ve],["__scopeId","data-v-d863e51e"]]),we={name:"DecisionCard",props:{decision:{type:Object,required:!0},slug:{type:String,default:"products"}}},ke={class:"flex flex-col justify-between h-[82px] p-3 bg-[#F4F4F4] rounded-lg transition-all duration-200 hover:shadow-md hover:bg-gray-50"},Ce={class:"name text-sm sm:text-base font-normal text-gray-900 leading-tight mb-2"};function qe(o,t,a,e,m,u){const n=$("router-link");return r(),D(n,{to:`/${a.slug}${a.decision.slug}`,class:"block"},{default:N(()=>[s("div",ke,[s("div",Ce,f(a.decision.name),1),t[0]||(t[0]=s("div",{class:"flex items-center justify-end gap-2"},[s("span",{class:"text-xs sm:text-sm font-normal text-[#688E67]"},"подробнее"),s("svg",{width:"16",height:"8",viewBox:"0 0 16 8",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M15.3536 4.35355C15.5488 4.15829 15.5488 3.84171 15.3536 3.64645L12.1716 0.464465C11.9763 0.269203 11.6597 0.269203 11.4645 0.464465C11.2692 0.659727 11.2692 0.97631 11.4645 1.17157L14.2929 4L11.4645 6.82843C11.2692 7.02369 11.2692 7.34027 11.4645 7.53553C11.6597 7.7308 11.9763 7.7308 12.1716 7.53553L15.3536 4.35355ZM0 4L4.37114e-08 4.5L15 4.5L15 4L15 3.5L-4.37114e-08 3.5L0 4Z",fill:"#688E67"})])],-1))])]),_:1},8,["to"])}const $e=k(we,[["render",qe]]),Se={name:"Decisions",components:{DecisionCard:$e,Transition:M,TransitionGroup:F},setup(){const o=h("Выберите решение под ваш участок"),t=h([]),a=h(!0),e=h(null),m=async()=>{try{const g=await fetch("/api/public/decision-block/settings");if(!g.ok)throw new Error("Ошибка загрузки настроек");const y=await g.json();y.data&&y.data.title&&(o.value=y.data.title)}catch(g){console.error("Ошибка загрузки настроек:",g)}},u=async()=>{a.value=!0,e.value=null;try{const g=await fetch("/api/public/decision-block/chapters");if(!g.ok)throw new Error("Ошибка загрузки данных");const V=(await g.json()).data||[];t.value=V.map((C,B)=>({id:C.id,name:C.name,active:B===0,items:[...(C.products||[]).map(q=>({...q,category:"products"})),...(C.services||[]).map(q=>({...q,category:"services"}))]})),t.value.length>0&&!t.value.find(C=>C.active)&&(t.value[0].active=!0)}catch(g){console.error("Ошибка загрузки разделов:",g),e.value="Не удалось загрузить данные. Попробуйте обновить страницу."}finally{a.value=!1}},n=I(()=>t.value.find(g=>g.active)||t.value[0]),c=I(()=>n.value?.items||[]),v=g=>{t.value.forEach(y=>{y.active=y.id===g.id})};return T(async()=>{await Promise.all([m(),u()])}),{title:o,chapters:t,activeChapter:n,activeItems:c,setActiveChapter:v,loading:a,error:e}}},je={class:"w-full px-3 sm:px-4 md:px-5 mt-8 sm:mt-12"},ze={class:"w-full max-w-[1200px] mx-auto"},Ie={class:"flex justify-center mb-6 sm:mb-8"},De={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900"},Ne={key:0,class:"flex justify-center items-center py-12"},Ee={key:1,class:"flex justify-center items-center py-12"},Qe={class:"text-red-500"},Te={key:0,class:"flex flex-col sm:flex-row gap-3 sm:gap-0 mb-6 sm:mb-8"},Ve=["onClick"];function Be(o,t,a,e,m,u){const n=$("DecisionCard");return r(),d("div",je,[s("div",ze,[s("div",Ie,[s("h2",De,f(e.title),1)]),e.loading?(r(),d("div",Ne,[...t[0]||(t[0]=[s("div",{class:"text-gray-500"},"Загрузка...",-1)])])):e.error?(r(),d("div",Ee,[s("div",Qe,f(e.error),1)])):(r(),d(j,{key:2},[e.chapters.length>0?(r(),d("div",Te,[(r(!0),d(j,null,E(e.chapters,(c,v)=>(r(),d("button",{key:c.id,onClick:g=>e.setActiveChapter(c),class:W(["flex-1 px-4 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-normal text-center transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-offset-2","rounded-lg sm:rounded-none",c.active?"bg-[#657C6C] text-white border border-[#657C6C] hover:bg-[#55695a] focus:ring-[#657C6C] shadow-md":"bg-white text-black border border-[#657C6C] hover:bg-[#D7D7D7] focus:ring-[#657C6C] shadow-sm",v===0?c.active?"sm:rounded-l-lg sm:rounded-r-none":"sm:rounded-l-lg sm:rounded-r-none sm:border-r-0":"",v===e.chapters.length-1?c.active?"sm:rounded-r-lg sm:rounded-l-none":"sm:rounded-r-lg sm:rounded-l-none sm:border-l-0":""])},f(c.name),11,Ve))),128))])):p("",!0),S(M,{name:"fade-slide",mode:"out-in"},{default:N(()=>[e.activeItems.length>0?(r(),d("div",{key:`content-${e.activeChapter?.id}`,class:"relative"},[S(F,{name:"stagger",tag:"div",class:"grid grid-cols-1 md:grid-cols-3 gap-4 sm:gap-6"},{default:N(()=>[(r(!0),d(j,null,E(e.activeItems,(c,v)=>(r(),D(n,{key:`${c.id}-${c.category}-${e.activeChapter?.id}`,decision:c,slug:c.category==="products"?"products":"services"},null,8,["decision","slug"]))),128))]),_:1})])):(r(),d("div",{key:`empty-${e.activeChapter?.id}`,class:"flex justify-center items-center py-12"},[...t[1]||(t[1]=[s("div",{class:"text-gray-500"},"В этом разделе пока нет элементов",-1)])]))]),_:1})],64))])])}const He=k(Se,[["render",Be],["__scopeId","data-v-9be57a33"]]),Me={name:"ImagesCollect",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(o){const t={id:o.id||o.name,name:o.name||"",title:o.title||o.name||"",text:o.title||o.name||"",src:o.src||o.webp||""};this.$emit("answer",t),o.child?setTimeout(()=>{this.$emit("next",o.child)},300):setTimeout(()=>{this.$emit("next")},300)},handleImageError(o){o.target.src="/upload/quiz/placeholder.jpg"}}},Ae={class:"mt-6"},Le={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},Oe={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},Fe={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},Pe={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4"},Re=["onClick"],Ue={class:"relative aspect-[245/140] sm:aspect-[245/140] rounded-2xl overflow-hidden shadow-md hover:shadow-lg transition-all duration-300 transform hover:scale-105"},We=["src","alt"],Je={class:"absolute top-3 left-3 right-3 z-10"},Ke={class:"text-white font-medium text-base sm:text-lg md:text-xl drop-shadow-lg"};function Ze(o,t,a,e,m,u){return r(),d("div",Ae,[s("div",Le,[s("div",Oe,f(a.data.id),1),s("div",Fe,f(a.data.question),1)]),s("div",Pe,[(r(!0),d(j,null,E(a.data.selects,n=>(r(),d("div",{key:n.id,class:"relative group cursor-pointer",onClick:c=>u.handleSelect(n)},[s("div",Ue,[s("img",{src:n.src||n.webp||"/upload/quiz/placeholder.jpg",alt:n.name||n.title,class:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110",onError:t[0]||(t[0]=(...c)=>u.handleImageError&&u.handleImageError(...c))},null,40,We),t[1]||(t[1]=s("div",{class:"absolute inset-0 bg-gradient-to-b from-black/60 via-black/20 to-transparent pointer-events-none"},null,-1)),s("div",Je,[s("h3",Ke,f(n.title),1)])])],8,Re))),128))])])}const Ge=k(Me,[["render",Ze]]),Xe={name:"Selects",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],methods:{handleSelect(o){const t={id:o.id||o.name,name:o.name||"",title:o.title||o.name||"",text:o.name||o.title||""};this.$emit("answer",t),setTimeout(()=>{this.$emit("next")},300)}}},Ye={class:"mt-6"},et={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},tt={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},st={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},nt={class:"space-y-3 sm:space-y-4 max-w-2xl"},ot=["onClick"];function at(o,t,a,e,m,u){return r(),d("div",Ye,[s("div",et,[s("div",tt,f(a.data.id),1),s("div",st,f(a.data.question),1)]),s("div",nt,[(r(!0),d(j,null,E(a.data.selects,n=>(r(),d("button",{key:n.id,onClick:c=>u.handleSelect(n),class:"w-full px-6 py-4 text-left bg-white border-2 border-gray-200 rounded-lg hover:border-[#657C6C] hover:bg-gray-50 transition-all duration-200 text-base sm:text-lg font-normal text-gray-900 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"},f(n.name),9,ot))),128))])])}const rt=k(Xe,[["render",at]]),it={name:"Inputs",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],setup(o,{emit:t}){const a=h(o.data?.answer||""),e=I(()=>{const u=a.value;return u==null?!1:u.toString().trim()!==""});return{answerValue:a,isAnswerValid:e,handleNext:()=>{const u=a.value?.toString().trim()||"";u&&(o.data&&(o.data.answer=u),t("answer",u),o.data?.child?t("next",o.data.child):t("next"))}}}},lt={class:"mt-6"},dt={class:"flex items-center gap-3 sm:gap-4 mb-6 px-2"},ct={class:"flex items-center justify-center w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-[#657C6C] text-white font-semibold text-lg sm:text-xl flex-shrink-0"},ut={class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900"},mt={class:"max-w-2xl"},xt={class:"block text-sm font-medium text-gray-700 mb-2"},ft={class:"flex flex-col sm:flex-row gap-3 sm:gap-4"},gt=["placeholder"],ht=["disabled"];function bt(o,t,a,e,m,u){return r(),d("div",lt,[s("div",dt,[s("div",ct,f(a.data.id),1),s("div",ut,f(a.data.question),1)]),s("div",mt,[s("label",xt,f(a.data.label),1),s("div",ft,[z(s("input",{"onUpdate:modelValue":t[0]||(t[0]=n=>e.answerValue=n),type:"text",placeholder:a.data.placeholder,onKeyup:t[1]||(t[1]=J((...n)=>e.handleNext&&e.handleNext(...n),["enter"])),class:"flex-1 w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors disabled:opacity-50 focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none"},null,40,gt),[[Q,e.answerValue]]),s("button",{onClick:t[2]||(t[2]=(...n)=>e.handleNext&&e.handleNext(...n)),disabled:!e.isAnswerValid,class:"px-6 sm:px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Далее ",8,ht)])])])}const _t=k(it,[["render",bt]]),pt={name:"Forms",props:{data:{type:Object,required:!0},numberQuestion:{type:Number,required:!0}},emits:["next","answer"],computed:{isFormValid(){return this.data.form.name&&this.data.form.name.trim()!==""&&this.data.form.email&&this.data.form.email.trim()!==""&&this.data.form.phone&&this.data.form.phone.trim()!==""&&this.data.form.check}},methods:{async handleSubmit(){this.isFormValid&&(this.$emit("answer",this.data.form),this.$emit("submit",{name:this.data.form.name,email:this.data.form.email,phone:this.data.form.phone}))}}},vt={class:"mt-6"},yt={class:"mb-6 px-2"},wt=["innerHTML"],kt={class:"max-w-2xl"},Ct={class:"flex items-start"},qt=["disabled"];function $t(o,t,a,e,m,u){return r(),d("div",vt,[s("div",yt,[s("div",{class:"question text-lg sm:text-xl md:text-2xl font-medium text-gray-900",innerHTML:a.data.question},null,8,wt)]),s("div",kt,[s("form",{onSubmit:t[4]||(t[4]=K((...n)=>u.handleSubmit&&u.handleSubmit(...n),["prevent"])),class:"space-y-4"},[s("div",null,[t[5]||(t[5]=s("label",{for:"quiz-name",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваше имя ",-1)),z(s("input",{id:"quiz-name","onUpdate:modelValue":t[0]||(t[0]=n=>a.data.form.name=n),type:"text",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"Иван Иванов"},null,512),[[Q,a.data.form.name]])]),s("div",null,[t[6]||(t[6]=s("label",{for:"quiz-email",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш email ",-1)),z(s("input",{id:"quiz-email","onUpdate:modelValue":t[1]||(t[1]=n=>a.data.form.email=n),type:"email",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"your@email.com"},null,512),[[Q,a.data.form.email]])]),s("div",null,[t[7]||(t[7]=s("label",{for:"quiz-phone",class:"block text-sm font-medium text-gray-700 mb-2"}," Ваш телефон ",-1)),z(s("input",{id:"quiz-phone","onUpdate:modelValue":t[2]||(t[2]=n=>a.data.form.phone=n),type:"tel",required:"",class:"w-full rounded-md border border-gray-300 bg-white px-4 py-3 text-sm sm:text-base transition-colors focus:border-[#657C6C] focus:ring-2 focus:ring-[#657C6C]/20 focus:outline-none",placeholder:"+7 (999) 123-45-67"},null,512),[[Q,a.data.form.phone]])]),s("div",Ct,[z(s("input",{id:"quiz-check","onUpdate:modelValue":t[3]||(t[3]=n=>a.data.form.check=n),type:"checkbox",required:"",class:"mt-1 h-4 w-4 rounded border-gray-300 text-[#657C6C] focus:ring-[#657C6C] focus:ring-2"},null,512),[[Z,a.data.form.check]]),t[8]||(t[8]=s("label",{for:"quiz-check",class:"ml-3 text-sm text-gray-600"}," Отправляя данную форму, вы соглашаетесь на обработку персональных данных ",-1))]),s("button",{type:"submit",disabled:!u.isFormValid,class:"w-full sm:w-auto px-8 py-3 bg-[#657C6C] hover:bg-[#55695a] disabled:bg-gray-400 disabled:cursor-not-allowed text-white font-medium rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-[#657C6C] focus:ring-offset-2"}," Отправить ",8,qt)],32)])])}const St=k(pt,[["render",$t]]),jt={name:"Thank",props:{data:{type:Object,default:()=>({})},numberQuestion:{type:Number,required:!0}}},zt={class:"mt-6"};function It(o,t,a,e,m,u){return r(),d("div",zt,[...t[0]||(t[0]=[G('<div class="flex flex-col items-center justify-center py-8 sm:py-12 px-4"><div class="w-16 h-16 sm:w-20 sm:h-20 rounded-full bg-green-100 flex items-center justify-center mb-6"><svg class="w-8 h-8 sm:w-10 sm:h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div><h3 class="text-xl sm:text-2xl md:text-3xl font-semibold text-gray-900 text-center mb-4"> Спасибо! </h3><p class="text-base sm:text-lg text-gray-600 text-center max-w-md"> Наши специалисты свяжутся с вами в течение 15 минут </p></div>',1)])])}const Dt=k(jt,[["render",It]]),Nt={name:"Quiz",components:{"images-collect":Ge,selects:rt,inputs:_t,forms:St,thank:Dt},props:{title:{type:String,default:"Подберите идеальное решение"},description:{type:String,default:"Ответьте на несколько вопросов, и мы предложим оптимальный вариант"}},setup(){const o=h(!0),t=h(null),a=h(null),e=h([]),m=h(1),u=h([]),n=h(!1),c=h({}),v=h(!1),g=h(!1),y=async()=>{try{const i=await fetch("/api/public/quiz-block/settings");if(!i.ok)throw new Error("Ошибка загрузки настроек");const l=await i.json();l.data?(n.value=l.data.is_active===!0,l.data.quiz_id?await V(l.data.quiz_id):o.value=!1):o.value=!1}catch(i){console.error("Ошибка загрузки настроек блока квиза:",i),o.value=!1}},V=async i=>{o.value=!0,t.value=null;try{const l=await fetch(`/api/public/quiz-block/quiz/${i}`);if(!l.ok)throw new Error("Ошибка загрузки квиза");const x=await l.json();x.data&&(a.value={id:x.data.id,title:x.data.title,description:x.data.description},e.value=(x.data.questions||[]).filter(b=>b.is_active!==!1).sort((b,_)=>(b.order||0)-(_.order||0)).map((b,_)=>({...b,displayId:_+1})),e.value.length>0&&(m.value=e.value[0].displayId,u.value=[]))}catch(l){t.value=l.message||"Ошибка загрузки квиза",console.error("Ошибка загрузки квиза:",l)}finally{o.value=!1}},C=i=>{const l={id:i.displayId||i.id||i.order,question:i.question_text||"",type:i.question_type,...i.question_data||{}};return(i.question_type==="images-collect"||i.question_type==="selects")&&i.question_data?.selects&&(l.selects=i.question_data.selects.map((x,b)=>({id:x.id||b+1,name:x.name||"",src:x.src||"",title:x.title||x.name||"",child:x.child||null}))),i.question_type==="inputs"&&i.question_data&&(l.label=i.question_data.label||"",l.placeholder=i.question_data.placeholder||"",l.child=i.question_data.child||null,l.answer=""),i.question_type==="forms"&&i.question_data&&(l.form=i.question_data.form||{name:"",email:"",phone:"",check:!1},l.child=i.question_data.child||null,l.question=i.question_text||i.question_data.question||""),l},B=I(()=>e.value.find(i=>i.displayId===m.value)),q=i=>{const l=m.value;if(l&&!u.value.includes(l)&&u.value.push(l),i){const x=e.value.findIndex(b=>b.displayId===m.value);i>0&&i<=e.value.length?m.value=i:x<e.value.length-1&&(m.value=e.value[x+1].displayId)}else{const x=e.value.findIndex(b=>b.displayId===m.value);x<e.value.length-1&&(m.value=e.value[x+1].displayId)}},P=()=>{const i=e.value.findIndex(l=>l.displayId===m.value);if(i>0){const l=e.value[i-1];if(l){const x=u.value.lastIndexOf(m.value);x!==-1&&(u.value=u.value.slice(0,x)),m.value=l.displayId}}},R=i=>{const l=e.value.find(x=>x.displayId===m.value);l&&(c.value[l.id]={question_id:l.id,question_text:l.question_text,question_type:l.question_type,answer:i})},A=async i=>{if(!(g.value||v.value)){g.value=!0;try{const l=e.value.filter(w=>c.value[w.id]).map(w=>c.value[w.id].answer),x=await fetch("/api/public/quiz/submit",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")||""},body:JSON.stringify({quiz_id:a.value.id,answers:l,contact:i})});let b="",_=null;try{if(b=await x.text(),b)try{_=JSON.parse(b)}catch(w){throw console.error("Ошибка парсинга JSON:",w,"Response text:",b.substring(0,200)),new Error("Сервер вернул некорректный ответ. Пожалуйста, попробуйте еще раз.")}}catch(w){throw console.error("Ошибка чтения ответа:",w),new Error("Ошибка получения ответа от сервера")}if(!x.ok){const w=_&&_.message||_&&_.error||`Ошибка сервера: ${x.status} ${x.statusText}`;throw new Error(w)}if(!_)throw console.error("Сервер вернул пустой ответ. Response text:",b.substring(0,200)),new Error("Сервер вернул пустой ответ");if(typeof _!="object")throw console.error("Сервер вернул некорректный тип данных:",typeof _,_),new Error("Сервер вернул некорректный ответ");if(_.success===!0)return v.value=!0,{success:!0,message:_.message||"Спасибо за прохождение квиза!"};{const w=_.message||_.error||"Ошибка отправки результатов квиза";throw new Error(w)}}catch(l){return console.error("Ошибка отправки результатов квиза:",l),{success:!1,message:l.message||"Ошибка отправки результатов квиза. Пожалуйста, попробуйте еще раз."}}finally{g.value=!1}}},U=async i=>{const l=await A(i);l.success?q():alert(l.message||"Произошла ошибка при отправке результатов. Пожалуйста, попробуйте еще раз.")};return T(()=>{y()}),{loading:o,error:t,quizData:a,questions:e,currentQuestionNumber:m,currentQuestion:B,isActive:n,isCompleted:v,isSubmitting:g,formatQuestionData:C,goToNext:q,goToPrevious:P,handleAnswer:R,handleSubmit:U,submitQuiz:A,questionHistory:u}}},Et={key:0,class:"w-full px-3 sm:px-4 md:px-5 mt-8 sm:mt-12 mb-8 sm:mb-12"},Qt={class:"w-full max-w-[1200px] mx-auto"},Tt={class:"flex flex-col items-center mb-6 sm:mb-8"},Vt={class:"text-2xl sm:text-3xl md:text-4xl font-semibold text-gray-900 text-center mb-3"},Bt={key:0,class:"text-gray-600 text-center text-base sm:text-lg"},Ht={key:0,class:"flex justify-center items-center py-12"},Mt={key:1,class:"flex justify-center items-center py-12"},At={class:"text-red-500"},Lt={key:0,class:"mb-4"};function Ot(o,t,a,e,m,u){return e.isActive?(r(),d("div",Et,[s("div",Qt,[s("div",Tt,[s("h2",Vt,f(e.quizData?.title||a.title),1),e.quizData?.description||a.description?(r(),d("p",Bt,f(e.quizData?.description||a.description),1)):p("",!0)]),e.loading?(r(),d("div",Ht,[...t[1]||(t[1]=[s("div",{class:"text-gray-500"},"Загрузка квиза...",-1)])])):e.error?(r(),d("div",Mt,[s("div",At,f(e.error),1)])):e.currentQuestion?(r(),D(M,{key:2,name:"quiz-fade",mode:"out-in"},{default:N(()=>[s("div",null,[e.questionHistory.length>0||e.currentQuestionNumber>1?(r(),d("div",Lt,[s("button",{onClick:t[0]||(t[0]=(...n)=>e.goToPrevious&&e.goToPrevious(...n)),class:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors text-sm sm:text-base"},[...t[2]||(t[2]=[s("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})],-1),O(" Назад ",-1)])])])):p("",!0),(r(),D(L(e.currentQuestion.question_type),{key:e.currentQuestion.id,data:e.formatQuestionData(e.currentQuestion),"number-question":e.currentQuestion.id,onNext:e.goToNext,onAnswer:e.handleAnswer,onSubmit:e.handleSubmit},null,40,["data","number-question","onNext","onAnswer","onSubmit"]))])]),_:1})):p("",!0)])])):p("",!0)}const Ft=k(Nt,[["render",Ot],["__scopeId","data-v-0991a741"]]),Pt={name:"Home",components:{HeroBanner:re,HowWork:ye,Decisions:He,Quiz:Ft}},Rt={class:"home-page"};function Ut(o,t,a,e,m,u){const n=$("HeroBanner"),c=$("HowWork"),v=$("Decisions"),g=$("Quiz");return r(),d("div",Rt,[S(n),S(c),S(v),S(g)])}const Jt=k(Pt,[["render",Ut]]);export{Jt as default};
