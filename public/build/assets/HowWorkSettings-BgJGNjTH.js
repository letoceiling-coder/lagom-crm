import{_ as h,e as l,h as t,f as u,t as m,i as c,v as f,D as S,F as C,k as V,r as g,o as U,G as y,d}from"./app-DB74vpAh.js";import{S as k}from"./sweetalert2.esm.all-C0u8rGqG.js";const B={name:"HowWorkSettings",setup(){const b=g(!0),o=g(!1),i=g(null),e=g({title:"",subtitle:"",is_active:!0,steps:[]}),v=async()=>{b.value=!0,i.value=null;try{const s=await y.get("/api/v1/how-work-block-settings");s.data&&s.data.data&&(e.value={title:s.data.data.title||"",subtitle:s.data.data.subtitle||"",is_active:s.data.data.is_active!==!1,steps:s.data.data.steps||[]})}catch(s){i.value=s.response?.data?.message||"Ошибка загрузки настроек",console.error("Error fetching settings:",s)}finally{b.value=!1}},x=()=>{e.value.steps||(e.value.steps=[]),e.value.steps.push({title:"",description:"",icon:""})},r=s=>{e.value.steps&&e.value.steps.length>s&&e.value.steps.splice(s,1)},a=(s,_)=>{if(!e.value.steps||e.value.steps.length<=1)return;const p=_==="up"?s-1:s+1;if(p>=0&&p<e.value.steps.length){const w=e.value.steps[s];e.value.steps[s]=e.value.steps[p],e.value.steps[p]=w}},n=async()=>{o.value=!0,i.value=null;try{const s=await y.put("/api/v1/how-work-block-settings",e.value);await k.fire({title:"Настройки сохранены",icon:"success",timer:2e3,showConfirmButton:!1,toast:!0,position:"top-end"})}catch(s){i.value=s.response?.data?.message||"Ошибка сохранения настроек",await k.fire({title:"Ошибка",text:i.value,icon:"error",confirmButtonText:"ОК"})}finally{o.value=!1}};return U(()=>{v()}),{loading:b,saving:o,error:i,form:e,addStep:x,removeStep:r,moveStep:a,saveSettings:n}}},j={class:"how-work-settings-page space-y-6"},D={key:0,class:"flex items-center justify-center py-12"},M={key:1,class:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg"},z={class:"text-destructive"},E={key:2,class:"space-y-6"},F={class:"bg-card rounded-lg border border-border p-6 space-y-6"},H={class:"space-y-4"},I={class:"flex items-center gap-2"},N={class:"bg-card rounded-lg border border-border p-6 space-y-6"},T={class:"flex items-center justify-between"},W={key:0,class:"text-center py-8 text-muted-foreground"},G={key:1,class:"space-y-4"},L={class:"flex items-center justify-between"},q={class:"font-semibold text-foreground"},A=["onClick"],J={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},K=["onUpdate:modelValue"],O={class:"md:col-span-2"},P=["onUpdate:modelValue"],Q=["onUpdate:modelValue"],R={class:"flex gap-2"},X=["onClick"],Y=["onClick"],Z={class:"flex justify-end gap-3 pt-4 border-t border-border"},$=["disabled"];function ee(b,o,i,e,v,x){return d(),l("div",j,[o[16]||(o[16]=t("div",null,[t("h1",{class:"text-3xl font-semibold text-foreground"},'Настройки блока "Как это работает"'),t("p",{class:"text-muted-foreground mt-1"},'Управление блоком "Как это работает" на главной странице')],-1)),e.loading?(d(),l("div",D,[...o[5]||(o[5]=[t("p",{class:"text-muted-foreground"},"Загрузка настроек...",-1)])])):u("",!0),e.error?(d(),l("div",M,[t("p",z,m(e.error),1)])):u("",!0),e.loading?u("",!0):(d(),l("div",E,[t("div",F,[o[9]||(o[9]=t("h2",{class:"text-xl font-semibold text-foreground"},"Общие настройки",-1)),t("div",H,[t("div",null,[o[6]||(o[6]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок блока ",-1)),c(t("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>e.form.title=r),type:"text",placeholder:"Как это работает",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,512),[[f,e.form.title]])]),t("div",null,[o[7]||(o[7]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Подзаголовок / Описание ",-1)),c(t("textarea",{"onUpdate:modelValue":o[1]||(o[1]=r=>e.form.subtitle=r),rows:"3",placeholder:"Простой процесс работы с нами",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent resize-none"},null,512),[[f,e.form.subtitle]])]),t("div",I,[c(t("input",{"onUpdate:modelValue":o[2]||(o[2]=r=>e.form.is_active=r),type:"checkbox",id:"is_active",class:"w-4 h-4 rounded border-border"},null,512),[[S,e.form.is_active]]),o[8]||(o[8]=t("label",{for:"is_active",class:"text-sm font-medium text-foreground"}," Блок активен на главной странице ",-1))])])]),t("div",N,[t("div",T,[o[10]||(o[10]=t("h2",{class:"text-xl font-semibold text-foreground"},"Шаги работы",-1)),t("button",{onClick:o[3]||(o[3]=(...r)=>e.addStep&&e.addStep(...r)),class:"px-4 py-2 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-colors text-sm font-medium"}," + Добавить шаг ")]),e.form.steps&&e.form.steps.length===0?(d(),l("div",W,[...o[11]||(o[11]=[t("p",null,"Нет шагов. Добавьте первый шаг.",-1)])])):(d(),l("div",G,[(d(!0),l(C,null,V(e.form.steps,(r,a)=>(d(),l("div",{key:a,class:"border border-border rounded-lg p-4 space-y-4"},[t("div",L,[t("h3",q,"Шаг "+m(a+1),1),t("button",{onClick:n=>e.removeStep(a),class:"px-3 py-1 text-sm text-destructive hover:bg-destructive/10 rounded transition-colors"}," Удалить ",8,A)]),t("div",J,[t("div",null,[o[12]||(o[12]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Иконка / Номер ",-1)),c(t("input",{"onUpdate:modelValue":n=>r.icon=n,type:"text",placeholder:"1, 2, 3 или эмодзи",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,8,K),[[f,r.icon]]),o[13]||(o[13]=t("p",{class:"text-xs text-muted-foreground mt-1"}," Если не указано, будет использован номер шага ",-1))]),t("div",O,[o[14]||(o[14]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Заголовок шага ",-1)),c(t("input",{"onUpdate:modelValue":n=>r.title=n,type:"text",placeholder:"Название шага",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent"},null,8,P),[[f,r.title]])])]),t("div",null,[o[15]||(o[15]=t("label",{class:"block text-sm font-medium text-foreground mb-2"}," Описание шага ",-1)),c(t("textarea",{"onUpdate:modelValue":n=>r.description=n,rows:"3",placeholder:"Подробное описание шага",class:"w-full px-4 py-2 bg-background border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-accent resize-none"},null,8,Q),[[f,r.description]])]),t("div",R,[a>0?(d(),l("button",{key:0,onClick:n=>e.moveStep(a,"up"),class:"px-3 py-1 text-sm border border-border hover:bg-accent/10 rounded transition-colors",title:"Переместить вверх"}," ↑ Вверх ",8,X)):u("",!0),a<e.form.steps.length-1?(d(),l("button",{key:1,onClick:n=>e.moveStep(a,"down"),class:"px-3 py-1 text-sm border border-border hover:bg-accent/10 rounded transition-colors",title:"Переместить вниз"}," ↓ Вниз ",8,Y)):u("",!0)])]))),128))]))]),t("div",Z,[t("button",{onClick:o[4]||(o[4]=(...r)=>e.saveSettings&&e.saveSettings(...r)),disabled:e.saving,class:"px-6 py-2 bg-accent text-accent-foreground rounded-lg hover:bg-accent/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium"},m(e.saving?"Сохранение...":"Сохранить настройки"),9,$)])]))])}const se=h(B,[["render",ee],["__scopeId","data-v-98effa88"]]);export{se as default};
